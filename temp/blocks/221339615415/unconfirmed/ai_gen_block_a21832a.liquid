{% doc %}
  @prompt
    Create a custom sign up form. 
    Including email address and mobile number. 
    Button colors can be changed, chosen from the theme setting / brand colors. 
    
    Validation for email 
    sign up
    can be vertical or horizontal, the mobile number MUST allowed for all countries, add a country dropdown for the mobile number sign up, add a second Button and Button label

{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-signup-form-{{ ai_gen_id }} {
    padding: {{ block.settings.form_padding }}px;
    background-color: {{ block.settings.background_color }};
    border-radius: {{ block.settings.border_radius }}px;
    max-width: 100%;
  }

  .ai-signup-form__content-{{ ai_gen_id }} {
    display: flex;
    {% if block.settings.layout == 'vertical' %}
      flex-direction: column;gap: 16px;
    {% else %}
      flex-direction: row;
      gap: 12px;
      align-items: flex-start;
    {% endif %}
  }

  .ai-signup-form__heading-{{ ai_gen_id }} {
    color: {{ block.settings.text_color }};
    margin: 0 0 16px 0;
    font-size: {{ block.settings.heading_size }}px;
    text-align: {{ block.settings.text_alignment }};
  }

  .ai-signup-form__subtext-{{ ai_gen_id }} {
    color: {{ block.settings.text_color }};
    font-size: {{ block.settings.text_size }}px;
    margin-bottom: 20px;
    text-align: {{ block.settings.text_alignment }};
  }

  .ai-signup-form__fields-{{ ai_gen_id }} {
    {% if block.settings.layout == 'vertical' %}
      width: 100%;
    {% else %}
      flex-grow: 1;
      display: flex;
      gap: 12px;
    {% endif %}
  }

  .ai-signup-form__field-group-{{ ai_gen_id }} {
    {% if block.settings.layout == 'vertical' %}
      margin-bottom: 16px;
    {% else %}
      flex: 1;
    {% endif %}
  }

  .ai-signup-form__label-{{ ai_gen_id }} {
    display: block;
    color: {{ block.settings.text_color }};
    font-size: 14px;
    margin-bottom: 6px;
    font-weight: 500;
  }

  .ai-signup-form__input-{{ ai_gen_id }} {
    width: 100%;
    padding: 12px 16px;
    border: 2px solid {{ block.settings.input_border_color }};
    border-radius: {{ block.settings.input_border_radius }}px;
    font-size: 16px;
    background-color: {{ block.settings.input_background_color }};
    color: {{ block.settings.input_text_color }};
    transition: border-color 0.3s ease;
  }

  .ai-signup-form__phone-wrapper-{{ ai_gen_id }} {
    display: flex;
    gap: 8px;
  }

  .ai-signup-form__country-select-{{ ai_gen_id }} {
    width: 120px;
    padding: 12px 8px;
    border: 2px solid {{ block.settings.input_border_color }};
    border-radius: {{ block.settings.input_border_radius }}px;
    font-size: 16px;
    background-color: {{ block.settings.input_background_color }};
    color: {{ block.settings.input_text_color }};
    transition: border-color 0.3s ease;
    flex-shrink: 0;
  }

  .ai-signup-form__phone-input-{{ ai_gen_id }} {
    flex-grow: 1;
    padding: 12px 16px;
    border: 2px solid {{ block.settings.input_border_color }};
    border-radius: {{ block.settings.input_border_radius }}px;
    font-size: 16px;
    background-color: {{ block.settings.input_background_color }};
    color: {{ block.settings.input_text_color }};
    transition: border-color 0.3s ease;
  }

  .ai-signup-form__input-{{ ai_gen_id }}:focus,
  .ai-signup-form__country-select-{{ ai_gen_id }}:focus,
  .ai-signup-form__phone-input-{{ ai_gen_id }}:focus {
    outline: none;
    border-color: {{ block.settings.input_focus_color }};
  }

  .ai-signup-form__input-{{ ai_gen_id }}.error,
  .ai-signup-form__country-select-{{ ai_gen_id }}.error,
  .ai-signup-form__phone-input-{{ ai_gen_id }}.error {
    border-color: {{ block.settings.error_color }};
  }

  .ai-signup-form__buttons-{{ ai_gen_id }} {
    {% if block.settings.layout == 'vertical' %}
      width: 100%;
      display: flex;
      gap: 12px;
    {% else %}
      display: flex;
      gap: 12px;
      flex-shrink: 0;
      align-self: flex-end;
    {% endif %}
  }

  .ai-signup-form__button-{{ ai_gen_id }} {
    {% if block.settings.layout == 'vertical' %}
      flex: 1;
    {% else %}
      padding: 12px 24px;
      flex-shrink: 0;
    {% endif %}
    padding: 14px 28px;
    background-color: rgb({{ block.settings.button_color_scheme.settings.primary_button_background.red }}, {{ block.settings.button_color_scheme.settings.primary_button_background.green }}, {{ block.settings.button_color_scheme.settings.primary_button_background.blue }});
    color: rgb({{ block.settings.button_color_scheme.settings.primary_button_text.red }}, {{ block.settings.button_color_scheme.settings.primary_button_text.green }}, {{ block.settings.button_color_scheme.settings.primary_button_text.blue }});
    border: 2px solid rgb({{ block.settings.button_color_scheme.settings.primary_button_border.red }}, {{ block.settings.button_color_scheme.settings.primary_button_border.green }}, {{ block.settings.button_color_scheme.settings.primary_button_border.blue }});
    border-radius: {{ block.settings.button_border_radius }}px;
    cursor: pointer;
    font-size: 16px;
    font-weight: 600;
    transition: all 0.3s ease;
  }

  .ai-signup-form__button-{{ ai_gen_id }}:hover {
    background-color: rgb({{ block.settings.button_color_scheme.settings.primary_button_hover_background.red }}, {{ block.settings.button_color_scheme.settings.primary_button_hover_background.green }}, {{ block.settings.button_color_scheme.settings.primary_button_hover_background.blue }});
    color: rgb({{ block.settings.button_color_scheme.settings.primary_button_hover_text.red }}, {{ block.settings.button_color_scheme.settings.primary_button_hover_text.green }}, {{ block.settings.button_color_scheme.settings.primary_button_hover_text.blue }});border-color: rgb({{ block.settings.button_color_scheme.settings.primary_button_hover_border.red }}, {{ block.settings.button_color_scheme.settings.primary_button_hover_border.green }}, {{ block.settings.button_color_scheme.settings.primary_button_hover_border.blue }});
  }

  .ai-signup-form__button-secondary-{{ ai_gen_id }} {
    {% if block.settings.layout == 'vertical' %}
      flex: 1;
    {% else %}
      padding: 12px 24px;
      flex-shrink: 0;
    {% endif %}
    padding: 14px 28px;
    background-color: rgb({{ block.settings.button_color_scheme.settings.secondary_button_background.red }}, {{ block.settings.button_color_scheme.settings.secondary_button_background.green }}, {{ block.settings.button_color_scheme.settings.secondary_button_background.blue }});
    color: rgb({{ block.settings.button_color_scheme.settings.secondary_button_text.red }}, {{ block.settings.button_color_scheme.settings.secondary_button_text.green }}, {{ block.settings.button_color_scheme.settings.secondary_button_text.blue }});
    border: 2px solid rgb({{ block.settings.button_color_scheme.settings.secondary_button_border.red }}, {{ block.settings.button_color_scheme.settings.secondary_button_border.green }}, {{ block.settings.button_color_scheme.settings.secondary_button_border.blue }});
    border-radius: {{ block.settings.button_border_radius }}px;
    cursor: pointer;
    font-size: 16px;
    font-weight: 600;
    transition: all 0.3s ease;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }

  .ai-signup-form__button-secondary-{{ ai_gen_id }}:hover {
    background-color: rgb({{ block.settings.button_color_scheme.settings.secondary_button_hover_background.red }}, {{ block.settings.button_color_scheme.settings.secondary_button_hover_background.green }}, {{ block.settings.button_color_scheme.settings.secondary_button_hover_background.blue }});
    color: rgb({{ block.settings.button_color_scheme.settings.secondary_button_hover_text.red }}, {{ block.settings.button_color_scheme.settings.secondary_button_hover_text.green }}, {{ block.settings.button_color_scheme.settings.secondary_button_hover_text.blue }});
    border-color: rgb({{ block.settings.button_color_scheme.settings.secondary_button_hover_border.red }}, {{ block.settings.button_color_scheme.settings.secondary_button_hover_border.green }}, {{ block.settings.button_color_scheme.settings.secondary_button_hover_border.blue }});
  }

  .ai-signup-form__error-message-{{ ai_gen_id }} {
    color: {{ block.settings.error_color }};
    font-size: 14px;
    margin-top: 6px;
    display: none;
  }

  .ai-signup-form__error-message-{{ ai_gen_id }}.show {
    display: block;
  }

  .ai-signup-form__success-message-{{ ai_gen_id }} {
    color: {{ block.settings.success_color }};
    font-size: 16px;
    text-align: center;
    padding: 20px;
    background-color: rgba({{ block.settings.success_color | color_extract: 'red' }}, {{ block.settings.success_color | color_extract: 'green' }}, {{ block.settings.success_color | color_extract: 'blue' }}, 0.1);
    border-radius: {{ block.settings.border_radius }}px;
    margin-top: 16px;
    display: none;
  }

  .ai-signup-form__success-message-{{ ai_gen_id }}.show {
    display: block;
  }

  @media screen and (max-width: 749px) {
    .ai-signup-form__content-{{ ai_gen_id }} {
      flex-direction: column;
      gap: 16px;
    }

    .ai-signup-form__fields-{{ ai_gen_id }} {
      width: 100%;
      flex-direction: column;
      gap: 16px;
    }

    .ai-signup-form__field-group-{{ ai_gen_id }} {
      flex: none;
      margin-bottom: 0;
    }

    .ai-signup-form__buttons-{{ ai_gen_id }} {
      width: 100%;
      flex-direction: column;
      align-self: stretch;
    }

    .ai-signup-form__button-{{ ai_gen_id }},
    .ai-signup-form__button-secondary-{{ ai_gen_id }} {
      width: 100%;
      flex: none;
    }

    .ai-signup-form__phone-wrapper-{{ ai_gen_id }} {
      flex-direction: column;
      gap: 12px;
    }

    .ai-signup-form__country-select-{{ ai_gen_id }} {
      width: 100%;
    }
  }
{% endstyle %}

<custom-signup-form-{{ ai_gen_id }}
  class="ai-signup-form-{{ ai_gen_id }}"
  {{ block.shopify_attributes }}
>
  {%- form 'contact' -%}
    <input type="hidden" name="contact[tags]" value="newsletter">
    
    {%- if block.settings.heading != blank -%}
      <h2 class="ai-signup-form__heading-{{ ai_gen_id }}">{{ block.settings.heading }}</h2>
    {%- endif -%}

    {%- if block.settings.subtext != blank -%}
      <div class="ai-signup-form__subtext-{{ ai_gen_id }}">{{ block.settings.subtext }}</div>
    {%- endif -%}

    <div class="ai-signup-form__content-{{ ai_gen_id }}">
      <div class="ai-signup-form__fields-{{ ai_gen_id }}">
        <div class="ai-signup-form__field-group-{{ ai_gen_id }}">
          <label for="email-{{ ai_gen_id }}" class="ai-signup-form__label-{{ ai_gen_id }}">
            Email Address *
          </label>
          <input
            type="email"
            id="email-{{ ai_gen_id }}"
            name="contact[email]"
            class="ai-signup-form__input-{{ ai_gen_id }}"
            value="{{ form.email }}"
            aria-required="true"
            autocorrect="off"
            autocapitalize="off"
            autocomplete="email"
            placeholder="{{ block.settings.email_placeholder }}"
            required
          ><div class="ai-signup-form__error-message-{{ ai_gen_id }}" id="email-error-{{ ai_gen_id }}">
            Please enter a valid email address
          </div>
        </div>

        <div class="ai-signup-form__field-group-{{ ai_gen_id }}">
          <label for="phone-{{ ai_gen_id }}" class="ai-signup-form__label-{{ ai_gen_id }}">
            Mobile Number
          </label>
          <div class="ai-signup-form__phone-wrapper-{{ ai_gen_id }}">
            <select
              id="country-{{ ai_gen_id }}"
              name="contact[country_code]"
              class="ai-signup-form__country-select-{{ ai_gen_id }}">
              <option value="+1">ğŸ‡ºğŸ‡¸ +1</option>
              <option value="+1">ğŸ‡¨ğŸ‡¦ +1</option>
              <option value="+44">ğŸ‡¬ğŸ‡§ +44</option>
              <option value="+33">ğŸ‡«ğŸ‡· +33</option>
              <option value="+49">ğŸ‡©ğŸ‡ª +49</option>
              <option value="+39">ğŸ‡®ğŸ‡¹ +39</option>
              <option value="+34">ğŸ‡ªğŸ‡¸ +34</option>
              <option value="+31">ğŸ‡³ğŸ‡± +31</option>
              <option value="+32">ğŸ‡§ğŸ‡ª +32</option>
              <option value="+41">ğŸ‡¨ğŸ‡­ +41</option>
              <option value="+43">ğŸ‡¦ğŸ‡¹ +43</option>
              <option value="+45">ğŸ‡©ğŸ‡° +45</option>
              <option value="+46">ğŸ‡¸ğŸ‡ª +46</option>
              <option value="+47">ğŸ‡³ğŸ‡´ +47</option>
              <option value="+358">ğŸ‡«ğŸ‡® +358</option>
              <option value="+353">ğŸ‡®ğŸ‡ª +353</option>
              <option value="+351">ğŸ‡µğŸ‡¹ +351</option>
              <option value="+30">ğŸ‡¬ğŸ‡· +30</option>
              <option value="+48">ğŸ‡µğŸ‡± +48</option>
              <option value="+420">ğŸ‡¨ğŸ‡¿ +420</option>
              <option value="+421">ğŸ‡¸ğŸ‡° +421</option>
              <option value="+36">ğŸ‡­ğŸ‡º +36</option>
              <option value="+385">ğŸ‡­ğŸ‡· +385</option>
              <option value="+386">ğŸ‡¸ğŸ‡® +386</option>
              <option value="+372">ğŸ‡ªğŸ‡ª +372</option>
              <option value="+371">ğŸ‡±ğŸ‡» +371</option>
              <option value="+370">ğŸ‡±ğŸ‡¹ +370</option>
              <option value="+7">ğŸ‡·ğŸ‡º +7</option>
              <option value="+380">ğŸ‡ºğŸ‡¦ +380</option>
              <option value="+375">ğŸ‡§ğŸ‡¾ +375</option>
              <option value="+374">ğŸ‡¦ğŸ‡² +374</option>
              <option value="+995">ğŸ‡¬ğŸ‡ª +995</option>
              <option value="+994">ğŸ‡¦ğŸ‡¿ +994</option>
              <option value="+7">ğŸ‡°ğŸ‡¿ +7</option>
              <option value="+996">ğŸ‡°ğŸ‡¬ +996</option>
              <option value="+992">ğŸ‡¹ğŸ‡¯ +992</option>
              <option value="+993">ğŸ‡¹ğŸ‡² +993</option>
              <option value="+998">ğŸ‡ºğŸ‡¿ +998</option>
              <option value="+81">ğŸ‡¯ğŸ‡µ +81</option>
              <option value="+82">ğŸ‡°ğŸ‡· +82</option>
              <option value="+86">ğŸ‡¨ğŸ‡³ +86</option>
              <option value="+852">ğŸ‡­ğŸ‡° +852</option>
              <option value="+853">ğŸ‡²ğŸ‡´ +853</option>
              <option value="+886">ğŸ‡¹ğŸ‡¼ +886</option>
              <option value="+65">ğŸ‡¸ğŸ‡¬ +65</option>
              <option value="+60">ğŸ‡²ğŸ‡¾ +60</option>
              <option value="+66">ğŸ‡¹ğŸ‡­ +66</option>
              <option value="+84">ğŸ‡»ğŸ‡³ +84</option>
              <option value="+63">ğŸ‡µğŸ‡­ +63</option>
              <option value="+62">ğŸ‡®ğŸ‡© +62</option>
              <option value="+855">ğŸ‡°ğŸ‡­ +855</option>
              <option value="+856">ğŸ‡±ğŸ‡¦ +856</option>
              <option value="+95">ğŸ‡²ğŸ‡² +95</option>
              <option value="+880">ğŸ‡§ğŸ‡© +880</option>
              <option value="+977">ğŸ‡³ğŸ‡µ +977</option>
              <option value="+975">ğŸ‡§ğŸ‡¹ +975</option>
              <option value="+94">ğŸ‡±ğŸ‡° +94</option>
              <option value="+960">ğŸ‡²ğŸ‡» +960</option>
              <option value="+91">ğŸ‡®ğŸ‡³ +91</option>
              <option value="+92">ğŸ‡µğŸ‡° +92</option>
              <option value="+93">ğŸ‡¦ğŸ‡« +93</option>
              <option value="+98">ğŸ‡®ğŸ‡· +98</option>
              <option value="+964">ğŸ‡®ğŸ‡¶ +964</option>
              <option value="+965">ğŸ‡°ğŸ‡¼ +965</option>
              <option value="+966">ğŸ‡¸ğŸ‡¦ +966</option>
              <option value="+973">ğŸ‡§ğŸ‡­ +973</option>
              <option value="+974">ğŸ‡¶ğŸ‡¦ +974</option>
              <option value="+971">ğŸ‡¦ğŸ‡ª +971</option>
              <option value="+968">ğŸ‡´ğŸ‡² +968</option>
              <option value="+967">ğŸ‡¾ğŸ‡ª +967</option>
              <option value="+962">ğŸ‡¯ğŸ‡´ +962</option>
              <option value="+961">ğŸ‡±ğŸ‡§ +961</option>
              <option value="+963">ğŸ‡¸ğŸ‡¾ +963</option>
              <option value="+972">ğŸ‡®ğŸ‡± +972</option>
              <option value="+970">ğŸ‡µğŸ‡¸ +970</option>
              <option value="+90">ğŸ‡¹ğŸ‡· +90</option>
              <option value="+357">ğŸ‡¨ğŸ‡¾ +357</option>
              <option value="+20">ğŸ‡ªğŸ‡¬ +20</option>
              <option value="+218">ğŸ‡±ğŸ‡¾ +218</option>
              <option value="+216">ğŸ‡¹ğŸ‡³ +216</option>
              <option value="+213">ğŸ‡©ğŸ‡¿ +213</option>
              <option value="+212">ğŸ‡²ğŸ‡¦ +212</option>
              <option value="+249">ğŸ‡¸ğŸ‡© +249</option>
              <option value="+251">ğŸ‡ªğŸ‡¹ +251</option>
              <option value="+254">ğŸ‡°ğŸ‡ª +254</option>
              <option value="+255">ğŸ‡¹ğŸ‡¿ +255</option>
              <option value="+256">ğŸ‡ºğŸ‡¬ +256</option>
              <option value="+250">ğŸ‡·ğŸ‡¼ +250</option>
              <option value="+257">ğŸ‡§ğŸ‡® +257</option>
              <option value="+243">ğŸ‡¨ğŸ‡© +243</option>
              <option value="+242">ğŸ‡¨ğŸ‡¬ +242</option>
              <option value="+236">ğŸ‡¨ğŸ‡« +236</option>
              <option value="+235">ğŸ‡¹ğŸ‡© +235</option>
              <option value="+237">ğŸ‡¨ğŸ‡² +237</option>
              <option value="+234">ğŸ‡³ğŸ‡¬ +234</option>
              <option value="+233">ğŸ‡¬ğŸ‡­ +233</option>
              <option value="+225">ğŸ‡¨ğŸ‡® +225</option>
              <option value="+226">ğŸ‡§ğŸ‡« +226</option>
              <option value="+223">ğŸ‡²ğŸ‡± +223</option>
              <option value="+221">ğŸ‡¸ğŸ‡³ +221</option>
              <option value="+220">ğŸ‡¬ğŸ‡² +220</option>
              <option value="+224">ğŸ‡¬ğŸ‡³ +224</option>
              <option value="+245">ğŸ‡¬ğŸ‡¼ +245</option>
              <option value="+238">ğŸ‡¨ğŸ‡» +238</option>
              <option value="+232">ğŸ‡¸ğŸ‡± +232</option>
              <option value="+231">ğŸ‡±ğŸ‡· +231</option>
              <option value="+27">ğŸ‡¿ğŸ‡¦ +27</option>
              <option value="+264">ğŸ‡³ğŸ‡¦ +264</option>
              <option value="+267">ğŸ‡§ğŸ‡¼ +267</option>
              <option value="+268">ğŸ‡¸ğŸ‡¿ +268</option>
              <option value="+266">ğŸ‡±ğŸ‡¸ +266</option>
              <option value="+258">ğŸ‡²ğŸ‡¿ +258</option>
              <option value="+260">ğŸ‡¿ğŸ‡² +260</option>
              <option value="+263">ğŸ‡¿ğŸ‡¼ +263</option>
              <option value="+265">ğŸ‡²ğŸ‡¼ +265</option>
              <option value="+261">ğŸ‡²ğŸ‡¬ +261</option>
              <option value="+230">ğŸ‡²ğŸ‡º +230</option>
              <option value="+248">ğŸ‡¸ğŸ‡¨ +248</option>
              <option value="+269">ğŸ‡°ğŸ‡² +269</option>
              <option value="+61">ğŸ‡¦ğŸ‡º +61</option>
              <option value="+64">ğŸ‡³ğŸ‡¿ +64</option>
              <option value="+679">ğŸ‡«ğŸ‡¯ +679</option>
              <option value="+685">ğŸ‡¼ğŸ‡¸ +685</option>
              <option value="+676">ğŸ‡¹ğŸ‡´ +676</option>
              <option value="+678">ğŸ‡»ğŸ‡º +678</option>
              <option value="+686">ğŸ‡°ğŸ‡® +686</option>
              <option value="+687">ğŸ‡³ğŸ‡¨ +687</option>
              <option value="+689">ğŸ‡µğŸ‡« +689</option>
              <option value="+684">ğŸ‡¦ğŸ‡¸ +684</option>
              <option value="+670">ğŸ‡¹ğŸ‡± +670</option>
              <option value="+675">ğŸ‡µğŸ‡¬ +675</option>
              <option value="+677">ğŸ‡¸ğŸ‡§ +677</option>
              <option value="+52">ğŸ‡²ğŸ‡½ +52</option>
              <option value="+502">ğŸ‡¬ğŸ‡¹ +502</option>
              <option value="+503">ğŸ‡¸ğŸ‡» +503</option>
              <option value="+504">ğŸ‡­ğŸ‡³ +504</option>
              <option value="+505">ğŸ‡³ğŸ‡® +505</option>
              <option value="+506">ğŸ‡¨ğŸ‡· +506</option>
              <option value="+507">ğŸ‡µğŸ‡¦ +507</option>
              <option value="+508">ğŸ‡µğŸ‡² +508</option>
              <option value="+509">ğŸ‡­ğŸ‡¹ +509</option>
              <option value="+590">ğŸ‡¬ğŸ‡µ +590</option>
              <option value="+591">ğŸ‡§ğŸ‡´ +591</option>
              <option value="+592">ğŸ‡¬ğŸ‡¾ +592</option>
              <option value="+593">ğŸ‡ªğŸ‡¨ +593</option>
              <option value="+594">ğŸ‡¬ğŸ‡« +594</option>
              <option value="+595">ğŸ‡µğŸ‡¾ +595</option>
              <option value="+596">ğŸ‡²ğŸ‡¶ +596</option>
              <option value="+597">ğŸ‡¸ğŸ‡· +597</option>
              <option value="+598">ğŸ‡ºğŸ‡¾ +598</option>
              <option value="+55">ğŸ‡§ğŸ‡· +55</option>
              <option value="+54">ğŸ‡¦ğŸ‡· +54</option>
              <option value="+56">ğŸ‡¨ğŸ‡± +56</option>
              <option value="+57">ğŸ‡¨ğŸ‡´ +57</option>
              <option value="+58">ğŸ‡»ğŸ‡ª +58</option>
              <option value="+51">ğŸ‡µğŸ‡ª +51</option>
            </select>
            <input
              type="tel"
              id="phone-{{ ai_gen_id }}"
              name="contact[phone]"
              class="ai-signup-form__phone-input-{{ ai_gen_id }}"
              autocomplete="tel"
              placeholder="{{ block.settings.phone_placeholder }}"
            >
          </div>
          <div class="ai-signup-form__error-message-{{ ai_gen_id }}" id="phone-error-{{ ai_gen_id }}">
            Please enter a valid mobile number
          </div>
        </div>
      </div>

      <div class="ai-signup-form__buttons-{{ ai_gen_id }}">
        <button
          type="submit"
          class="ai-signup-form__button-{{ ai_gen_id }}">
          {{ block.settings.button_label }}
        </button>

        {% if block.settings.second_button_label != blank and block.settings.second_button_link != blank %}
          <a
            href="{{ block.settings.second_button_link }}"
            class="ai-signup-form__button-secondary-{{ ai_gen_id }}">
            {{ block.settings.second_button_label }}
          </a>
        {% endif %}
      </div>
    </div>

    {%- if form.errors -%}
      <div class="ai-signup-form__error-message-{{ ai_gen_id }} show">
        {%- for field in form.errors -%}
          {{ form.errors.messages[field] }}
        {%- endfor -%}
      </div>
    {%- endif -%}

    {%- if form.posted_successfully? -%}
      <div class="ai-signup-form__success-message-{{ ai_gen_id }} show">
        {{ block.settings.success_message }}
      </div>
    {%- endif -%}
  {%- endform -%}
</custom-signup-form-{{ ai_gen_id }}>

<script>
(function() {
  class CustomSignupForm{{ ai_gen_id }} extends HTMLElement {
    constructor() {
      super();
    }

    connectedCallback() {
      this.form = this.querySelector('form');
      this.emailInput = this.querySelector('#email-{{ ai_gen_id }}');
      this.phoneInput = this.querySelector('#phone-{{ ai_gen_id }}');
      this.countrySelect = this.querySelector('#country-{{ ai_gen_id }}');
      this.emailError = this.querySelector('#email-error-{{ ai_gen_id }}');
      this.phoneError = this.querySelector('#phone-error-{{ ai_gen_id }}');

      this.setupEventListeners();
    }

    setupEventListeners() {
      this.emailInput.addEventListener('blur', () => this.validateEmail());
      this.emailInput.addEventListener('input', () => this.clearEmailError());
      this.phoneInput.addEventListener('blur', () => this.validatePhone());
      this.phoneInput.addEventListener('input', () => this.clearPhoneError());

      this.form.addEventListener('submit', (e) => this.handleSubmit(e));
    }

    validateEmail() {
      const email = this.emailInput.value.trim();
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      
      if (email && !emailRegex.test(email)) {
        this.showEmailError();
        return false;
      }
      
      this.clearEmailError();
      return true;
    }

    validatePhone() {
      const phone = this.phoneInput.value.trim();
      
      if (phone) {
        const cleanPhone = phone.replace(/[\s\-\(\)\.]/g, '');
        const phoneRegex = /^[0-9]{7,15}$/;
        
        if (!phoneRegex.test(cleanPhone)) {
          this.showPhoneError();
          return false;
        }
      }
      
      this.clearPhoneError();
      return true;
    }

    showEmailError() {
      this.emailInput.classList.add('error');
      this.emailError.classList.add('show');
    }

    clearEmailError() {
      this.emailInput.classList.remove('error');
      this.emailError.classList.remove('show');
    }

    showPhoneError() {
      this.phoneInput.classList.add('error');
      this.phoneError.classList.add('show');
    }

    clearPhoneError() {
      this.phoneInput.classList.remove('error');
      this.phoneError.classList.remove('show');
    }

    handleSubmit(e) {
      const isEmailValid = this.validateEmail();
      const isPhoneValid = this.validatePhone();
      
      if (!isEmailValid || !isPhoneValid) {
        e.preventDefault();
        return false;
      }
      
      const countryCode = this.countrySelect.value;
      const phoneNumber = this.phoneInput.value.trim();
      
      if (phoneNumber) {
        const fullPhoneNumber = countryCode + phoneNumber;
        this.phoneInput.value = fullPhoneNumber;
      }
      
      return true;
    }
  }

  customElements.define('custom-signup-form-{{ ai_gen_id }}', CustomSignupForm{{ ai_gen_id }});
})();
</script>

{% schema %}
{
  "name": "Custom signup form",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "richtext",
      "id": "heading",
      "label": "Heading",
      "default": "<p>Stay in the loop</p>"
    },
    {
      "type": "richtext",
      "id": "subtext",
      "label": "Subtext",
      "default": "<p>Subscribe to our newsletter for the latest updates and exclusive offers.</p>"
    },
    {
      "type": "text",
      "id": "email_placeholder",
      "label": "Email placeholder",
      "default": "Enter your email address"
    },
    {
      "type": "text",
      "id": "phone_placeholder",
      "label": "Phone placeholder",
      "default": "123 456 7890"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Primary button label",
      "default": "Sign Up"
    },
    {
      "type": "text",
      "id": "second_button_label",
      "label": "Secondary button label",
      "default": "Learn More"
    },
    {
      "type": "url",
      "id": "second_button_link",
      "label": "Secondary button link"
    },
    {
      "type": "richtext",
      "id": "success_message",
      "label": "Success message",
      "default": "<p>Thank you for subscribing! We'll be in touch soon.</p>"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Form layout",
      "options": [
        {
          "value": "horizontal",
          "label": "Horizontal"
        },
        {
          "value": "vertical",
          "label": "Vertical"
        }
      ],
      "default": "horizontal"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Text alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "left"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#f8f8f8"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#000000"
    },
    {
      "type": "color_scheme",
      "id": "button_color_scheme",
      "label": "Button color scheme",
      "default": "scheme-1"
    },
    {
      "type": "color",
      "id": "input_background_color",
      "label": "Input background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "input_text_color",
      "label": "Input text color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "input_border_color",
      "label": "Input border color",
      "default": "#e0e0e0"
    },
    {
      "type": "color",
      "id": "input_focus_color",
      "label": "Input focus color",
      "default": "#007acc"
    },
    {
      "type": "color",
      "id": "error_color",
      "label": "Error color",
      "default": "#d82c0d"
    },
    {
      "type": "color",
      "id": "success_color",
      "label": "Success color",
      "default": "#008060"
    },
    {
      "type": "header",
      "content": "Style"
    },
    {
      "type": "range",
      "id": "form_padding",
      "min": 0,
      "max": 60,
      "step": 4,
      "unit": "px",
      "label": "Form padding",
      "default": 32
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Form border radius",
      "default": 8
    },
    {
      "type": "range",
      "id": "input_border_radius",
      "min": 0,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Input border radius",
      "default": 6
    },
    {
      "type": "range",
      "id": "button_border_radius",
      "min": 0,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Button border radius",
      "default": 6
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 16,
      "max": 48,
      "step": 2,
      "unit": "px",
      "label": "Heading size",
      "default": 28
    },
    {
      "type": "range",
      "id": "text_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Text size",
      "default": 16
    }
  ],
  "presets": [
    {
      "name": "Custom signup form"
    }
  ]
}
{% endschema %}