{% doc %}
  @prompt
    Can we have a sign up block with email address sign up AND mobile number sign up. 
    
    Choice of colors for the buttons base on the brand colors. 
    The Mobile Number sign up should allowed for all countries.

{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-signup-form-{{ ai_gen_id }} {
    padding: {{ block.settings.padding }}px;
    background-color: {{ block.settings.background_color }};
    border-radius: {{ block.settings.border_radius }}px;
    max-width: {{ block.settings.max_width }}px;
    margin: 0 auto;}

  .ai-signup-form__content-{{ ai_gen_id }} {
    display: flex;
    flex-direction: column;
    gap:24px;
  }

  .ai-signup-form__heading-{{ ai_gen_id }} {
    color: {{ block.settings.text_color }};
    margin: 0;
    font-size: {{ block.settings.heading_size }}px;
    text-align: {{ block.settings.text_alignment }};
  }

  .ai-signup-form__subtext-{{ ai_gen_id }} {
    color: {{ block.settings.text_color }};
    font-size: {{ block.settings.text_size }}px;
    text-align: {{ block.settings.text_alignment }};
    margin: 0;
  }

  .ai-signup-form__tabs-{{ ai_gen_id }} {
    display: flex;
    border-radius: {{ block.settings.tab_border_radius }}px;
    overflow: hidden;
    border: 1px solid {{ block.settings.tab_border_color }};
  }

  .ai-signup-form__tab-{{ ai_gen_id }} {
    flex: 1;
    padding: 12px 16px;
    background-color: {{ block.settings.tab_inactive_bg }};
    color: {{ block.settings.tab_inactive_text }};
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 14px;
    font-weight: 500;
  }

  .ai-signup-form__tab-{{ ai_gen_id }}:not(:last-child) {
    border-right: 1px solid {{ block.settings.tab_border_color }};
  }

  .ai-signup-form__tab-{{ ai_gen_id }}.active {
    background-color: {{ block.settings.tab_active_bg }};
    color: {{ block.settings.tab_active_text }};
  }

  .ai-signup-form__tab-{{ ai_gen_id }}:hover {
    background-color: {{ block.settings.tab_hover_bg }};
  }

  .ai-signup-form__form-container-{{ ai_gen_id }} {
    position: relative;
  }

  .ai-signup-form__form-{{ ai_gen_id }} {
    display: none;
  }

  .ai-signup-form__form-{{ ai_gen_id }}.active {
    display: block;
  }

  .ai-signup-form__field-group-{{ ai_gen_id }} {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-bottom: 16px;
  }

  .ai-signup-form__label-{{ ai_gen_id }} {
    color: {{ block.settings.text_color }};
    font-size: 14px;
    font-weight: 500;
  }

  .ai-signup-form__input-{{ ai_gen_id }} {
    padding: 12px 16px;
    border: 1px solid {{ block.settings.input_border_color }};
    border-radius: {{ block.settings.input_border_radius }}px;
    font-size: 16px;
    background-color: {{ block.settings.input_background }};
    color: {{ block.settings.input_text_color }};
  }

  .ai-signup-form__input-{{ ai_gen_id }}:focus {
    outline: none;
    border-color: {{ block.settings.input_focus_border }};
    box-shadow: 0 0 0 2px {{ block.settings.input_focus_border }}33;
  }

  .ai-signup-form__phone-group-{{ ai_gen_id }} {
    display: flex;
    gap: 8px;
  }

  .ai-signup-form__country-select-{{ ai_gen_id }} {
    flex: 0 0 120px;
    padding: 12px 8px;
    border: 1px solid {{ block.settings.input_border_color }};
    border-radius: {{ block.settings.input_border_radius }}px;
    background-color: {{ block.settings.input_background }};
    color: {{ block.settings.input_text_color }};
    font-size: 14px;
  }

  .ai-signup-form__phone-input-{{ ai_gen_id }} {
    flex: 1;
  }

  .ai-signup-form__button-{{ ai_gen_id }} {
    width: 100%;
    padding: 14px 24px;
    background-color: {{ block.settings.button_color }};
    color: {{ block.settings.button_text_color }};
    border: none;
    border-radius: {{ block.settings.button_border_radius }}px;
    cursor: pointer;
    font-size: 16px;
    font-weight: 600;
    transition: background-color 0.3s ease;
  }

  .ai-signup-form__button-{{ ai_gen_id }}:hover {
    background-color: {{ block.settings.button_hover_color }};
  }

  .ai-signup-form__message-{{ ai_gen_id }} {
    margin-top: 12px;
    padding: 12px;
    border-radius: 4px;
    font-size: 14px;
  }

  .ai-signup-form__success-{{ ai_gen_id }} {
    background-color: {{ block.settings.success_bg }};
    color: {{ block.settings.success_text }};
    border: 1px solid {{ block.settings.success_border }};
  }

  .ai-signup-form__error-{{ ai_gen_id }} {
    background-color: {{ block.settings.error_bg }};
    color: {{ block.settings.error_text }};
    border: 1px solid {{ block.settings.error_border }};
  }

  @media screen and (max-width: 749px) {
    .ai-signup-form-{{ ai_gen_id }} {
      padding: {{ block.settings.padding | times: 0.7 }}px;
    }

    .ai-signup-form__phone-group-{{ ai_gen_id }} {
      flex-direction: column;
    }

    .ai-signup-form__country-select-{{ ai_gen_id }} {
      flex: none;
    }
  }
{% endstyle %}

<signup-form-{{ ai_gen_id }}
  class="ai-signup-form-{{ ai_gen_id }}"
  {{ block.shopify_attributes }}
>
  <div class="ai-signup-form__content-{{ ai_gen_id }}">
    {% if block.settings.heading != blank %}
      <h2 class="ai-signup-form__heading-{{ ai_gen_id }}">{{ block.settings.heading }}</h2>
    {% endif %}

    {% if block.settings.subtext != blank %}
      <div class="ai-signup-form__subtext-{{ ai_gen_id }}">{{ block.settings.subtext }}</div>
    {% endif %}<div class="ai-signup-form__tabs-{{ ai_gen_id }}"><button
        type="button"
        class="ai-signup-form__tab-{{ ai_gen_id }} active"
        data-tab="email"
      >
        {{ block.settings.email_tab_label }}
      </button>
      <button
        type="button"
        class="ai-signup-form__tab-{{ ai_gen_id }}"
        data-tab="phone"
      >
        {{ block.settings.phone_tab_label }}
      </button>
    </div>

    <div class="ai-signup-form__form-container-{{ ai_gen_id }}">
      {% form 'contact' %}
        <div class="ai-signup-form__form-{{ ai_gen_id }} active" data-form="email">
          <input type="hidden" name="contact[signup_type]" value="email">
          
          <div class="ai-signup-form__field-group-{{ ai_gen_id }}">
            <label for="email-{{ ai_gen_id }}" class="ai-signup-form__label-{{ ai_gen_id }}">
              {{ block.settings.email_label }}
            </label>
            <input
              type="email"
              id="email-{{ ai_gen_id }}"
              name="contact[email]"
              class="ai-signup-form__input-{{ ai_gen_id }}"
              placeholder="{{ block.settings.email_placeholder }}"
              required
              autocomplete="email"
            >
          </div>

          <button type="submit" class="ai-signup-form__button-{{ ai_gen_id }}">
            {{ block.settings.email_button_text }}
          </button>
        </div>
      {% endform %}

      {% form 'contact' %}
        <div class="ai-signup-form__form-{{ ai_gen_id }}" data-form="phone">
          <input type="hidden" name="contact[signup_type]" value="phone">
          
          <div class="ai-signup-form__field-group-{{ ai_gen_id }}">
            <label for="phone-{{ ai_gen_id }}" class="ai-signup-form__label-{{ ai_gen_id }}">
              {{ block.settings.phone_label }}
            </label>
            <div class="ai-signup-form__phone-group-{{ ai_gen_id }}">
              <select class="ai-signup-form__country-select-{{ ai_gen_id }}" name="contact[country_code]"><option value="+1">ðŸ‡ºðŸ‡¸ +1</option>
                <option value="+1">ðŸ‡¨ðŸ‡¦ +1</option>
                <option value="+44">ðŸ‡¬ðŸ‡§ +44</option>
                <option value="+33">ðŸ‡«ðŸ‡· +33</option>
                <option value="+49">ðŸ‡©ðŸ‡ª +49</option>
                <option value="+39">ðŸ‡®ðŸ‡¹ +39</option>
                <option value="+34">ðŸ‡ªðŸ‡¸ +34</option>
                <option value="+31">ðŸ‡³ðŸ‡± +31</option>
                <option value="+32">ðŸ‡§ðŸ‡ª +32</option>
                <option value="+41">ðŸ‡¨ðŸ‡­ +41</option>
                <option value="+43">ðŸ‡¦ðŸ‡¹ +43</option>
                <option value="+45">ðŸ‡©ðŸ‡° +45</option>
                <option value="+46">ðŸ‡¸ðŸ‡ª +46</option>
                <option value="+47">ðŸ‡³ðŸ‡´ +47</option>
                <option value="+358">ðŸ‡«ðŸ‡® +358</option>
                <option value="+61">ðŸ‡¦ðŸ‡º +61</option>
                <option value="+64">ðŸ‡³ðŸ‡¿ +64</option>
                <option value="+81">ðŸ‡¯ðŸ‡µ +81</option>
                <option value="+82">ðŸ‡°ðŸ‡· +82</option>
                <option value="+86">ðŸ‡¨ðŸ‡³ +86</option>
                <option value="+91">ðŸ‡®ðŸ‡³ +91</option>
                <option value="+55">ðŸ‡§ðŸ‡· +55</option>
                <option value="+52">ðŸ‡²ðŸ‡½ +52</option>
                <option value="+54">ðŸ‡¦ðŸ‡· +54</option>
                <option value="+56">ðŸ‡¨ðŸ‡± +56</option>
                <option value="+57">ðŸ‡¨ðŸ‡´ +57</option>
                <option value="+51">ðŸ‡µðŸ‡ª +51</option>
                <option value="+58">ðŸ‡»ðŸ‡ª +58</option>
                <option value="+27">ðŸ‡¿ðŸ‡¦ +27</option>
                <option value="+20">ðŸ‡ªðŸ‡¬ +20</option>
                <option value="+234">ðŸ‡³ðŸ‡¬ +234</option>
                <option value="+254">ðŸ‡°ðŸ‡ª +254</option>
                <option value="+971">ðŸ‡¦ðŸ‡ª +971</option>
                <option value="+966">ðŸ‡¸ðŸ‡¦ +966</option>
                <option value="+65">ðŸ‡¸ðŸ‡¬ +65</option>
                <option value="+60">ðŸ‡²ðŸ‡¾ +60</option>
                <option value="+66">ðŸ‡¹ðŸ‡­ +66</option>
                <option value="+84">ðŸ‡»ðŸ‡³ +84</option>
                <option value="+63">ðŸ‡µðŸ‡­ +63</option>
                <option value="+62">ðŸ‡®ðŸ‡© +62</option>
                <option value="+7">ðŸ‡·ðŸ‡º +7</option>
                <option value="+380">ðŸ‡ºðŸ‡¦ +380</option>
                <option value="+48">ðŸ‡µðŸ‡± +48</option>
                <option value="+420">ðŸ‡¨ðŸ‡¿ +420</option>
                <option value="+36">ðŸ‡­ðŸ‡º +36</option>
                <option value="+40">ðŸ‡·ðŸ‡´ +40</option>
                <option value="+359">ðŸ‡§ðŸ‡¬ +359</option>
                <option value="+385">ðŸ‡­ðŸ‡· +385</option>
                <option value="+386">ðŸ‡¸ðŸ‡® +386</option>
                <option value="+421">ðŸ‡¸ðŸ‡° +421</option>
                <option value="+372">ðŸ‡ªðŸ‡ª +372</option>
                <option value="+371">ðŸ‡±ðŸ‡» +371</option>
                <option value="+370">ðŸ‡±ðŸ‡¹ +370</option>
              </select>
              <input
                type="tel"
                id="phone-{{ ai_gen_id }}"
                name="contact[phone]"
                class="ai-signup-form__input-{{ ai_gen_id }} ai-signup-form__phone-input-{{ ai_gen_id }}"
                placeholder="{{ block.settings.phone_placeholder }}"
                required
                autocomplete="tel"
              >
            </div>
          </div>

          <button type="submit" class="ai-signup-form__button-{{ ai_gen_id }}">
            {{ block.settings.phone_button_text }}
          </button>
        </div>
      {% endform %}
    </div>

    {% if form.posted_successfully? %}
      <div class="ai-signup-form__message-{{ ai_gen_id }} ai-signup-form__success-{{ ai_gen_id }}">
        {{ block.settings.success_message }}
      </div>
    {% endif %}

    {% if form.errors %}
      <div class="ai-signup-form__message-{{ ai_gen_id }} ai-signup-form__error-{{ ai_gen_id }}">
        {{ block.settings.error_message }}
      </div>
    {% endif %}
  </div>
</signup-form-{{ ai_gen_id }}>

<script>
  (function() {
    class SignupForm{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
      }

      connectedCallback() {
        this.tabs = this.querySelectorAll('.ai-signup-form__tab-{{ ai_gen_id }}');
        this.forms = this.querySelectorAll('.ai-signup-form__form-{{ ai_gen_id }}');
        this.setupEventListeners();
      }

      setupEventListeners() {
        this.tabs.forEach(tab => {
          tab.addEventListener('click', () => {
            const targetTab = tab.dataset.tab;
            this.switchTab(targetTab);
          });
        });
      }

      switchTab(targetTab) {
        this.tabs.forEach(tab => {
          tab.classList.remove('active');
          if (tab.dataset.tab === targetTab) {
            tab.classList.add('active');
          }
        });

        this.forms.forEach(form => {
          form.classList.remove('active');
          if (form.dataset.form === targetTab) {
            form.classList.add('active');
          }
        });
      }
    }

    customElements.define('signup-form-{{ ai_gen_id }}', SignupForm{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Email and phone signup",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "richtext",
      "id": "heading",
      "label": "Heading",
      "default": "<p>Stay connected with us</p>"
    },
    {
      "type": "richtext",
      "id": "subtext",
      "label": "Subtext",
      "default": "<p>Get the latest updates and exclusive offers</p>"
    },
    {
      "type": "text",
      "id": "email_tab_label",
      "label": "Email tab label",
      "default": "Email signup"
    },
    {
      "type": "text",
      "id": "phone_tab_label",
      "label": "Phone tab label",
      "default": "SMS signup"
    },
    {
      "type": "header",
      "content": "Email form"
    },
    {
      "type": "text",
      "id": "email_label",
      "label": "Email field label",
      "default": "Email address"
    },
    {
      "type": "text",
      "id": "email_placeholder",
      "label": "Email placeholder",
      "default": "Enter your email"
    },
    {
      "type": "text",
      "id": "email_button_text",
      "label": "Email button text",
      "default": "Subscribe"
    },
    {
      "type": "header",
      "content": "Phone form"
    },
    {
      "type": "text",
      "id": "phone_label",
      "label": "Phone field label",
      "default": "Phone number"
    },
    {
      "type": "text",
      "id": "phone_placeholder",
      "label": "Phone placeholder",
      "default": "Enter your phone number"
    },
    {
      "type": "text",
      "id": "phone_button_text",
      "label": "Phone button text",
      "default": "Subscribe"
    },
    {
      "type": "header",
      "content": "Messages"
    },
    {
      "type": "text",
      "id": "success_message",
      "label": "Success message",
      "default": "Thank you for subscribing!"
    },
    {
      "type": "text",
      "id": "error_message",
      "label": "Error message",
      "default": "Please check your information and try again."
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Text alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "max_width",
      "min": 300,
      "max": 800,
      "step": 20,
      "unit": "px",
      "label": "Maximum width",
      "default": 500
    },
    {
      "type": "range",
      "id": "padding",
      "min": 20,
      "max": 80,
      "step": 4,
      "unit": "px",
      "label": "Padding",
      "default": 40
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#1d4d41"
    },
    {
      "type": "color",
      "id": "button_color",
      "label": "Button color",
      "default": "#1d4d41"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button text color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_hover_color",
      "label": "Button hover color",
      "default": "#0b2e25"
    },
    {
      "type": "header",
      "content": "Tab colors"
    },
    {
      "type": "color",
      "id": "tab_active_bg",
      "label": "Active tab background",
      "default": "#1d4d41"
    },
    {
      "type": "color",
      "id": "tab_active_text",
      "label": "Active tab text",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "tab_inactive_bg",
      "label": "Inactive tab background",
      "default": "#f5f7f8"
    },
    {
      "type": "color",
      "id": "tab_inactive_text",
      "label": "Inactive tab text",
      "default": "#1d4d41"
    },
    {
      "type": "color",
      "id": "tab_hover_bg",
      "label": "Tab hover background",
      "default": "#e5edeb"
    },
    {
      "type": "color",
      "id": "tab_border_color",
      "label": "Tab border color",
      "default": "#bacbc6"
    },
    {
      "type": "header",
      "content": "Input colors"
    },
    {
      "type": "color",
      "id": "input_background",
      "label": "Input background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "input_text_color",
      "label": "Input text color",
      "default": "#1d4d41"
    },
    {
      "type": "color",
      "id": "input_border_color",
      "label": "Input border color",
      "default": "#bacbc6"
    },
    {
      "type": "color",
      "id": "input_focus_border",
      "label": "Input focus border",
      "default": "#1d4d41"
    },
    {
      "type": "header",
      "content": "Message colors"
    },
    {
      "type": "color",
      "id": "success_bg",
      "label": "Success background",
      "default": "#d4edda"
    },
    {
      "type": "color",
      "id": "success_text",
      "label": "Success text",
      "default": "#155724"
    },
    {
      "type": "color",
      "id": "success_border",
      "label": "Success border",
      "default": "#c3e6cb"
    },
    {
      "type": "color",
      "id": "error_bg",
      "label": "Error background",
      "default": "#f8d7da"
    },
    {
      "type": "color",
      "id": "error_text",
      "label": "Error text",
      "default": "#721c24"
    },
    {
      "type": "color",
      "id": "error_border",
      "label": "Error border",
      "default": "#f5c6cb"
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 16,
      "max": 48,
      "step": 2,
      "unit": "px",
      "label": "Heading size",
      "default": 28
    },
    {
      "type": "range",
      "id": "text_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Text size",
      "default": 16
    },
    {
      "type": "header",
      "content": "Border radius"
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 24,
      "step": 2,
      "unit": "px",
      "label": "Form border radius",
      "default": 8
    },
    {
      "type": "range",
      "id": "tab_border_radius",
      "min": 0,
      "max": 16,
      "step": 1,
      "unit": "px",
      "label": "Tab border radius",
      "default": 6
    },
    {
      "type": "range",
      "id": "input_border_radius",
      "min": 0,
      "max": 16,
      "step": 1,
      "unit": "px",
      "label": "Input border radius",
      "default": 4
    },
    {
      "type": "range",
      "id": "button_border_radius",
      "min": 0,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Button border radius",
      "default": 6
    }
  ],
  "presets": [
    {
      "name": "Email and phone signup"
    }
  ],
  "tag": null
}
{% endschema %}