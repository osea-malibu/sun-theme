{% doc %}
  Sign-up Block

  Overview
  - Dual-purpose signup form with tabs for Email and Phone.
  - Uses theme typography and theme color scheme only (no custom colors/sizes).
  - Layout width supports Fit (fixed, centered) or Fill (full width).
  - Accessible labels, keyboard focus, and smooth tab transitions.

  Usage
  - Add this block, set content labels and tab titles.
  - Pick Width: Fit or Fill; adjust padding and border radii as desired.
  - Choose a Background color scheme from theme color schemes.

  Notes
  - All colors derive from the selected theme color scheme
    (foreground, background, primary, border, hover).
  - Typography inherits from the theme; alignment is configurable.

  Dependencies
  - Requires block.id for unique CSS class generation
  - JS for tab switching; form handling by Shopify 'contact' form

  Author: Mirabelle Doiron
  Version: 1.1
  Last Updated: 2025-08-07
{% enddoc %}
{% assign signup_form_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .signup-form-{{ signup_form_id }} {
    padding: {{ block.settings.padding }}px;
    background-color: var(--color-background);
    border-radius: {{ block.settings.border_radius }}px;
    {% if block.settings.width == 'fit' %}
      max-width: 800px;
      margin: 0 auto;
    {% else %}
      max-width: 100%;
      margin: 0;
    {% endif %}
  }

  .signup-form__content-{{ signup_form_id }} {
    display: flex;
    {% if block.settings.layout == 'horizontal' %}
      flex-direction: row;
      align-items: center;
      gap: 32px;
    {% else %}
      flex-direction: column;
      gap: 24px;
    {% endif %}
  }

  .signup-form__heading-{{ signup_form_id }} {
    color: var(--color-foreground-heading);
    margin: 0;
    text-align: {{ block.settings.text_alignment }};
  }

  .signup-form__subtext-{{ signup_form_id }} {
    color: var(--color-foreground);
    text-align: {{ block.settings.text_alignment }};
    margin: 0;
  }

  .signup-form__tabs-{{ signup_form_id }} {
    display: flex;
    border-radius: {{ block.settings.tab_border_radius }}px;
    overflow: hidden;
    border: 1px solid var(--color-border);
  }

  .signup-form__tab-{{ signup_form_id }} {
    flex: 1;
    padding: 12px 16px;
    background-color: var(--color-background);
    color: var(--color-foreground);
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 14px;
    font-weight: 500;
  }

  .signup-form__tab-{{ signup_form_id }}:not(:last-child) {
    border-right: 1px solid var(--color-border);
  }

  .signup-form__tab-{{ signup_form_id }}.active {
    background-color: var(--color-primary);
    color: var(--color-background);
  }

  .signup-form__tab-{{ signup_form_id }}:hover {
    background-color: var(--color-primary-hover);
    color: var(--color-background);
  }

  .signup-form__form-container-{{ signup_form_id }} {
    position: relative;
  }

  .signup-form__form-{{ signup_form_id }} {
    display: none;
  }

  .signup-form__form-{{ signup_form_id }}.active {
    display: block;
  }

  .signup-form__field-group-{{ signup_form_id }} {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-bottom: 16px;
  }

  .signup-form__label-{{ signup_form_id }} {
    color: var(--color-foreground);
    font-size: 14px;
    font-weight: 500;
  }

  .signup-form__input-{{ signup_form_id }} {
    padding: 12px 16px;
    border: 1px solid var(--color-border);
    border-radius: {{ block.settings.input_border_radius }}px;
    font-size: 16px;
    background-color: var(--color-background);
    color: var(--color-foreground);
  }

  .signup-form__input-{{ signup_form_id }}:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 2px rgba(var(--color-primary-rgb), 0.2);
  }

  .signup-form__phone-group-{{ signup_form_id }} {
    display: flex;
    gap: 8px;
  }

  .signup-form__country-select-{{ signup_form_id }} {
    flex: 0 0 120px;
    padding: 12px 8px;
    border: 1px solid var(--color-border);
    border-radius: {{ block.settings.input_border_radius }}px;
    background-color: var(--color-background);
    color: var(--color-foreground);
    font-size: 14px;
  }

  .signup-form__phone-input-{{ signup_form_id }} {
    flex: 1;
  }

  .signup-form__button-{{ signup_form_id }} {
    width: 100%;
    padding: 14px 24px;
    background-color: var(--color-primary);
    color: var(--color-background);
    border: none;
    border-radius: {{ block.settings.button_border_radius }}px;
    cursor: pointer;
    font-size: 16px;
    font-weight: 600;
    transition: background-color 0.3s ease;
  }

  .signup-form__button-{{ signup_form_id }}:hover {
    background-color: var(--color-primary-hover);
  }

  .signup-form__message-{{ signup_form_id }} {
    margin-top: 12px;
    padding: 12px;
    border-radius: 4px;
    font-size: 14px;
    border: 1px solid var(--color-border);
    color: var(--color-foreground);
  }

  .signup-form__success-{{ signup_form_id }} {
    background-color: transparent;
  }

  .signup-form__error-{{ signup_form_id }} {
    background-color: transparent;
  }

  @media screen and (max-width: 749px) {
    .signup-form-{{ signup_form_id }} {
      padding: {{ block.settings.padding | times: 0.7 }}px;
    }

    .signup-form__content-{{ signup_form_id }} {
      flex-direction: column;
      gap: 24px;
    }

    .signup-form__phone-group-{{ signup_form_id }} {
      flex-direction: column;
    }

    .signup-form__country-select-{{ signup_form_id }} {
      flex: none;
    }
  }
{% endstyle %}

<signup-form-{{ signup_form_id }}
  class="signup-form-{{ signup_form_id }} color-{{ block.settings.color_scheme }}"
  {{ block.shopify_attributes }}
>
  <div class="signup-form__content-{{ signup_form_id }}">
    {% if block.settings.heading != blank %}
      <h2 class="signup-form__heading-{{ signup_form_id }} text-block {{ block.settings.heading_preset }}">{{ block.settings.heading }}</h2>
    {% endif %}

    {% if block.settings.subtext != blank %}
      <div class="signup-form__subtext-{{ signup_form_id }} text-block {{ block.settings.text_preset }}">{{ block.settings.subtext }}</div>
    {% endif %}<div class="signup-form__tabs-{{ signup_form_id }}"><button
        type="button"
        class="signup-form__tab-{{ signup_form_id }} active"
        data-tab="email"
      >
        {{ block.settings.email_tab_label }}
      </button>
      <button
        type="button"
        class="signup-form__tab-{{ signup_form_id }}"
        data-tab="phone"
      >
        {{ block.settings.phone_tab_label }}
      </button>
    </div>

    <div class="signup-form__form-container-{{ signup_form_id }}">
      {% form 'contact' %}
                  <div class="signup-form__form-{{ signup_form_id }} active" data-form="email">
          <input type="hidden" name="contact[signup_type]" value="email">
          
          <div class="signup-form__field-group-{{ signup_form_id }}">
            <label for="email-{{ signup_form_id }}" class="signup-form__label-{{ signup_form_id }}">
              {{ block.settings.email_label }}
            </label>
            <input
              type="email"
              id="email-{{ signup_form_id }}"
              name="contact[email]"
              class="signup-form__input-{{ signup_form_id }}"
              placeholder="{{ block.settings.email_placeholder }}"
              required
              autocomplete="email"
            >
          </div>

          <button type="submit" class="signup-form__button-{{ signup_form_id }}">
            {{ block.settings.email_button_text }}
          </button>

          {% if form.posted_successfully? %}
            <div class="signup-form__message-{{ signup_form_id }} signup-form__success-{{ signup_form_id }}">
              {{ block.settings.success_message }}
            </div>
          {% endif %}

          {% if form.errors %}
            <div class="signup-form__message-{{ signup_form_id }} signup-form__error-{{ signup_form_id }}">
              {{ block.settings.error_message }}
            </div>
          {% endif %}
        </div>
      {% endform %}

      {% form 'contact' %}
        <div class="signup-form__form-{{ signup_form_id }}" data-form="phone">
          <input type="hidden" name="contact[signup_type]" value="phone">
          
          <div class="signup-form__field-group-{{ signup_form_id }}">
            <label for="phone-{{ signup_form_id }}" class="signup-form__label-{{ signup_form_id }}">
              {{ block.settings.phone_label }}
            </label>
            <div class="signup-form__phone-group-{{ signup_form_id }}">
              <select class="signup-form__country-select-{{ signup_form_id }}" name="contact[country_code]"><option value="+1">ðŸ‡ºðŸ‡¸ +1</option>
                <option value="+1">ðŸ‡¨ðŸ‡¦ +1</option>
                <option value="+44">ðŸ‡¬ðŸ‡§ +44</option>
                <option value="+33">ðŸ‡«ðŸ‡· +33</option>
                <option value="+49">ðŸ‡©ðŸ‡ª +49</option>
                <option value="+39">ðŸ‡®ðŸ‡¹ +39</option>
                <option value="+34">ðŸ‡ªðŸ‡¸ +34</option>
                <option value="+31">ðŸ‡³ðŸ‡± +31</option>
                <option value="+32">ðŸ‡§ðŸ‡ª +32</option>
                <option value="+41">ðŸ‡¨ðŸ‡­ +41</option>
                <option value="+43">ðŸ‡¦ðŸ‡¹ +43</option>
                <option value="+45">ðŸ‡©ðŸ‡° +45</option>
                <option value="+46">ðŸ‡¸ðŸ‡ª +46</option>
                <option value="+47">ðŸ‡³ðŸ‡´ +47</option>
                <option value="+358">ðŸ‡«ðŸ‡® +358</option>
                <option value="+61">ðŸ‡¦ðŸ‡º +61</option>
                <option value="+64">ðŸ‡³ðŸ‡¿ +64</option>
                <option value="+81">ðŸ‡¯ðŸ‡µ +81</option>
                <option value="+82">ðŸ‡°ðŸ‡· +82</option>
                <option value="+86">ðŸ‡¨ðŸ‡³ +86</option>
                <option value="+91">ðŸ‡®ðŸ‡³ +91</option>
                <option value="+55">ðŸ‡§ðŸ‡· +55</option>
                <option value="+52">ðŸ‡²ðŸ‡½ +52</option>
                <option value="+54">ðŸ‡¦ðŸ‡· +54</option>
                <option value="+56">ðŸ‡¨ðŸ‡± +56</option>
                <option value="+57">ðŸ‡¨ðŸ‡´ +57</option>
                <option value="+51">ðŸ‡µðŸ‡ª +51</option>
                <option value="+58">ðŸ‡»ðŸ‡ª +58</option>
                <option value="+27">ðŸ‡¿ðŸ‡¦ +27</option>
                <option value="+20">ðŸ‡ªðŸ‡¬ +20</option>
                <option value="+234">ðŸ‡³ðŸ‡¬ +234</option>
                <option value="+254">ðŸ‡°ðŸ‡ª +254</option>
                <option value="+971">ðŸ‡¦ðŸ‡ª +971</option>
                <option value="+966">ðŸ‡¸ðŸ‡¦ +966</option>
                <option value="+65">ðŸ‡¸ðŸ‡¬ +65</option>
                <option value="+60">ðŸ‡²ðŸ‡¾ +60</option>
                <option value="+66">ðŸ‡¹ðŸ‡­ +66</option>
                <option value="+84">ðŸ‡»ðŸ‡³ +84</option>
                <option value="+63">ðŸ‡µðŸ‡­ +63</option>
                <option value="+62">ðŸ‡®ðŸ‡© +62</option>
                <option value="+7">ðŸ‡·ðŸ‡º +7</option>
                <option value="+380">ðŸ‡ºðŸ‡¦ +380</option>
                <option value="+48">ðŸ‡µðŸ‡± +48</option>
                <option value="+420">ðŸ‡¨ðŸ‡¿ +420</option>
                <option value="+36">ðŸ‡­ðŸ‡º +36</option>
                <option value="+40">ðŸ‡·ðŸ‡´ +40</option>
                <option value="+359">ðŸ‡§ðŸ‡¬ +359</option>
                <option value="+385">ðŸ‡­ðŸ‡· +385</option>
                <option value="+386">ðŸ‡¸ðŸ‡® +386</option>
                <option value="+421">ðŸ‡¸ðŸ‡° +421</option>
                <option value="+372">ðŸ‡ªðŸ‡ª +372</option>
                <option value="+371">ðŸ‡±ðŸ‡» +371</option>
                <option value="+370">ðŸ‡±ðŸ‡¹ +370</option>
              </select>
              <input
                type="tel"
                id="phone-{{ signup_form_id }}"
                name="contact[phone]"
                class="signup-form__input-{{ signup_form_id }} signup-form__phone-input-{{ signup_form_id }}"
                placeholder="{{ block.settings.phone_placeholder }}"
                required
                autocomplete="tel"
              >
            </div>
          </div>

          <button type="submit" class="signup-form__button-{{ signup_form_id }}">
            {{ block.settings.phone_button_text }}
          </button>

          {% if form.posted_successfully? %}
            <div class="signup-form__message-{{ signup_form_id }} signup-form__success-{{ signup_form_id }}">
              {{ block.settings.success_message }}
            </div>
          {% endif %}

          {% if form.errors %}
            <div class="signup-form__message-{{ signup_form_id }} signup-form__error-{{ signup_form_id }}">
              {{ block.settings.error_message }}
            </div>
          {% endif %}
        </div>
      {% endform %}
    </div>
  </div>
</signup-form-{{ signup_form_id }}>

<script>
  (function() {
    class SignupForm{{ signup_form_id }} extends HTMLElement {
      constructor() {
        super();
      }

      connectedCallback() {
        this.tabs = this.querySelectorAll('.signup-form__tab-{{ signup_form_id }}');
        this.forms = this.querySelectorAll('.signup-form__form-{{ signup_form_id }}');
        this.setupEventListeners();
      }

      setupEventListeners() {
        this.tabs.forEach(tab => {
          tab.addEventListener('click', () => {
            const targetTab = tab.dataset.tab;
            this.switchTab(targetTab);
          });
        });
      }

      switchTab(targetTab) {
        this.tabs.forEach(tab => {
          tab.classList.remove('active');
          if (tab.dataset.tab === targetTab) {
            tab.classList.add('active');
          }
        });

        this.forms.forEach(form => {
          form.classList.remove('active');
          if (form.dataset.form === targetTab) {
            form.classList.add('active');
          }
        });
      }
    }

    customElements.define('signup-form-{{ signup_form_id }}', SignupForm{{ signup_form_id }});
  })();
</script>

{% schema %}
{
  "name": "Signup Form",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "richtext",
      "id": "heading",
      "label": "Heading",
      "default": "<p>Stay connected with us</p>"
    },
    {
      "type": "richtext",
      "id": "subtext",
      "label": "Subtext",
      "default": "<p>Get the latest updates and exclusive offers</p>"
    },
    {
      "type": "text",
      "id": "email_tab_label",
      "label": "Email tab label",
      "default": "Email signup"
    },
    {
      "type": "text",
      "id": "phone_tab_label",
      "label": "Phone tab label",
      "default": "SMS signup"
    },
    {
      "type": "header",
      "content": "Email form"
    },
    {
      "type": "text",
      "id": "email_label",
      "label": "Email field label",
      "default": "Email address"
    },
    {
      "type": "text",
      "id": "email_placeholder",
      "label": "Email placeholder",
      "default": "Enter your email"
    },
    {
      "type": "text",
      "id": "email_button_text",
      "label": "Email button text",
      "default": "Subscribe"
    },
    {
      "type": "header",
      "content": "Phone form"
    },
    {
      "type": "text",
      "id": "phone_label",
      "label": "Phone field label",
      "default": "Phone number"
    },
    {
      "type": "text",
      "id": "phone_placeholder",
      "label": "Phone placeholder",
      "default": "Enter your phone number"
    },
    {
      "type": "text",
      "id": "phone_button_text",
      "label": "Phone button text",
      "default": "Subscribe"
    },
    {
      "type": "header",
      "content": "Messages"
    },
    {
      "type": "text",
      "id": "success_message",
      "label": "Success message",
      "default": "Thank you for subscribing!"
    },
    {
      "type": "text",
      "id": "error_message",
      "label": "Error message",
      "default": "Please check your information and try again."
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "width",
      "label": "Width",
      "options": [
        { "value": "fit", "label": "Fit" },
        { "value": "fill", "label": "Fill" }
      ],
      "default": "fit"
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Layout",
      "options": [
        {
          "value": "vertical",
          "label": "Vertical"
        },
        {
          "value": "horizontal",
          "label": "Horizontal"
        }
      ],
      "default": "vertical"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Text alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "max_width_type",
      "label": "Maximum width type",
      "options": [
        {
          "value": "px",
          "label": "Pixels"
        },
        {
          "value": "percent",
          "label": "Percentage"
        }
      ],
      "default": "px"
    },
    {
      "type": "range",
      "id": "max_width_px",
      "min": 300,
      "max": 800,
      "step": 20,
      "unit": "px",
      "label": "Maximum width (pixels)",
      "default": 500,
      "visible_if": "{{ block.settings.max_width_type == 'px' }}"
    },
    {
      "type": "range",
      "id": "max_width_percent",
      "min": 20,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "Maximum width (percentage)",
      "default": 80,
      "visible_if": "{{ block.settings.max_width_type == 'percent' }}"
    },
    {
      "type": "range",
      "id": "padding",
      "min": 20,
      "max": 80,
      "step": 4,
      "unit": "px",
      "label": "Padding",
      "default": 40
    },
    {
      "type": "header",
      "content": "Appearance"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Background color scheme",
      "default": "scheme-1"
    },
    
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "select",
      "id": "heading_preset",
      "label": "Heading",
      "options": [
        { "value": "", "label": "Default" },
        { "value": "paragraph", "label": "Paragraph" },
        { "value": "h1", "label": "H1" },
        { "value": "h2", "label": "H2" },
        { "value": "h3", "label": "H3" },
        { "value": "h4", "label": "H4" },
        { "value": "h5", "label": "H5" },
        { "value": "h6", "label": "H6" }
      ],
      "default": "h3"
    },
    {
      "type": "select",
      "id": "text_preset",
      "label": "Text",
      "options": [
        { "value": "rte", "label": "Default" },
        { "value": "paragraph", "label": "Paragraph" },
        { "value": "h1", "label": "H1" },
        { "value": "h2", "label": "H2" },
        { "value": "h3", "label": "H3" },
        { "value": "h4", "label": "H4" },
        { "value": "h5", "label": "H5" },
        { "value": "h6", "label": "H6" }
      ],
      "default": "rte"
    },
    {
      "type": "header",
      "content": "Border radius"
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 24,
      "step": 2,
      "unit": "px",
      "label": "Form border radius",
      "default": 8
    },
    {
      "type": "range",
      "id": "tab_border_radius",
      "min": 0,
      "max": 16,
      "step": 1,
      "unit": "px",
      "label": "Tab border radius",
      "default": 6
    },
    {
      "type": "range",
      "id": "input_border_radius",
      "min": 0,
      "max": 16,
      "step": 1,
      "unit": "px",
      "label": "Input border radius",
      "default": 4
    },
    {
      "type": "range",
      "id": "button_border_radius",
      "min": 0,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Button border radius",
      "default": 6
    }
  ],
  "presets": [
    {
      "name": "Signup Form"
    }
  ],
  "tag": null
}
{% endschema %}